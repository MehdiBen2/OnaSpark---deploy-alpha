{% extends "departement/exploitation.html" %}

{% block content %}
<div class="container-fluid mt-4">
    <div class="card shadow-sm">
        <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
            <h3 class="card-title mb-0 d-flex align-items-center">
                <i class="fas fa-building me-2"></i>Infrastructures
            </h3>
            <button type="button" class="btn btn-light" data-bs-toggle="modal" data-bs-target="#infrastructureModal">
                <i class="fas fa-plus me-1"></i>Ajouter Infrastructure
            </button>
        </div>
        <div class="card-body">
            <table id="infrastructuresTable" class="table table-hover table-striped">
                <thead class="table-light">
                    <tr>
                        <th><i class="fas fa-tag me-1"></i>Nom</th>
                        <th><i class="fas fa-cubes me-1"></i>Type</th>
                        <th><i class="fas fa-map-marker-alt me-1"></i>Localisation</th>
                        <th><i class="fas fa-chart-bar me-1"></i>Capacité</th>
                        <th><i class="fas fa-power-off me-1"></i>État</th>
                        <th><i class="fas fa-cogs me-1"></i>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for infrastructure in infrastructures %}
                    <tr class="infrastructure-row" data-id="{{ infrastructure.id }}" style="cursor: pointer;">
                        <td>{{ infrastructure.nom }}</td>
                        <td>{{ infrastructure.type }}</td>
                        <td>{{ infrastructure.localisation }}</td>
                        <td>{{ infrastructure.capacite }}</td>
                        <td>
                            {% if infrastructure.etat == 'OPERATIONNEL' %}
                            <span class="badge bg-success"><i class="fas fa-check-circle me-1"></i>Opérationnel</span>
                            {% elif infrastructure.etat == 'MAINTENANCE' %}
                            <span class="badge bg-warning"><i class="fas fa-wrench me-1"></i>En maintenance</span>
                            {% elif infrastructure.etat == 'PANNE' %}
                            <span class="badge bg-danger"><i class="fas fa-exclamation-triangle me-1"></i>En panne</span>
                            {% else %}
                            <span class="badge bg-secondary">{{ infrastructure.etat }}</span>
                            {% endif %}
                        </td>
                        <td>
                            <div class="btn-group" role="group">
                                <button class="btn btn-sm btn-outline-info" title="Éditer">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-danger delete-infrastructure" data-id="{{ infrastructure.id }}" title="Supprimer">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Add Infrastructure Modal -->
    <div class="modal fade" id="infrastructureModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Ajouter une Infrastructure</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="infrastructureForm">
                        <div class="mb-3">
                            <label for="nom" class="form-label">Nom</label>
                            <input type="text" class="form-control" id="nom" required>
                        </div>
                        <div class="mb-3">
                            <label for="type" class="form-label">Type</label>
                            <div class="input-group">
                                <select class="form-select" id="type" required>
                                    <option value="">Sélectionner un type</option>
                                    <option value="STEP">Station d'épuration</option>
                                    <option value="SP">Station de pompage</option>
                                    <option value="AUTRE">Autre</option>
                                </select>
                                <button class="btn btn-outline-primary" type="button" id="connectStepBtn" title="Connecter à la Station d'Épuration" data-bs-toggle="modal" data-bs-target="#connectStepModal">
                                    <i class="fas fa-link me-1"></i>Connecter
                                </button>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="localisation" class="form-label">Localisation</label>
                            <input type="text" class="form-control" id="localisation" required>
                        </div>
                        <div class="mb-3">
                            <label for="capacite" class="form-label">Capacité</label>
                            <input type="number" class="form-control" id="capacite" required>
                        </div>
                        <div class="mb-3">
                            <label for="etat" class="form-label">État</label>
                            <select class="form-select" id="etat" required>
                                <option value="">Sélectionner un état</option>
                                <option value="OPERATIONNEL">Opérationnel</option>
                                <option value="MAINTENANCE">En maintenance</option>
                                <option value="PANNE">En panne</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="button" class="btn btn-primary" id="saveInfrastructureBtn">Enregistrer</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for Connecting to STEP -->
    <div class="modal fade" id="connectStepModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-link me-2"></i>Connecter à la Station d'Épuration
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header">
                                    <h6 class="mb-0">
                                        <i class="fas fa-water me-2"></i>Stations d'Épuration Disponibles
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <div class="list-group" id="availableStepList">
                                        <!-- Dynamically populated list of available STEP -->
                                        <a href="#" class="list-group-item list-group-item-action">
                                            <div class="d-flex w-100 justify-content-between">
                                                <h5 class="mb-1">STEP Centrale</h5>
                                                <small class="text-muted">Capacité: 50,000 m³/jour</small>
                                            </div>
                                            <p class="mb-1">Localisation: Zone Industrielle Nord</p>
                                        </a>
                                        <a href="#" class="list-group-item list-group-item-action">
                                            <div class="d-flex w-100 justify-content-between">
                                                <h5 class="mb-1">STEP Secondaire</h5>
                                                <small class="text-muted">Capacité: 25,000 m³/jour</small>
                                            </div>
                                            <p class="mb-1">Localisation: Quartier Résidentiel Est</p>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0">
                                        <i class="fas fa-info-circle me-2"></i>Détails de Connexion
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <form id="stepConnectionForm">
                                        <div class="mb-3">
                                            <label for="selectedStep" class="form-label">Station d'Épuration</label>
                                            <select class="form-select" id="selectedStep" required>
                                                <option value="">Sélectionner une station</option>
                                                <option value="step_centrale">STEP Centrale</option>
                                                <option value="step_secondaire">STEP Secondaire</option>
                                            </select>
                                        </div>
                                        <div class="mb-3">
                                            <label for="connectionType" class="form-label">Type de Connexion</label>
                                            <select class="form-select" id="connectionType" required>
                                                <option value="">Choisir un type</option>
                                                <option value="direct">Connexion Directe</option>
                                                <option value="indirect">Connexion Indirecte</option>
                                            </select>
                                        </div>
                                        <div class="mb-3">
                                            <label for="connectionCapacity" class="form-label">Capacité de Connexion (m³/jour)</label>
                                            <input type="number" class="form-control" id="connectionCapacity" required>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-1"></i>Annuler
                    </button>
                    <button type="button" class="btn btn-primary" id="confirmStepConnectionBtn">
                        <i class="fas fa-check me-1"></i>Confirmer la Connexion
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Infrastructure Details Modal -->
    <div class="modal fade" id="infrastructureDetailsModal" tabindex="-1" data-bs-backdrop="static">
        <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content shadow-lg border-0">
                <div class="modal-header bg-gradient-primary text-white p-4 border-0">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-building fa-2x me-3 text-white-50"></i>
                        <div>
                            <h3 class="modal-title mb-1" id="infrastructureDetailsTitle">Détails de l'Infrastructure</h3>
                            <small class="text-white-75" id="infrastructureDetailsSubtitle">Informations détaillées et documents</small>
                        </div>
                    </div>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                
                <div class="modal-body p-4">
                    <div class="row g-4">
                        <!-- Infrastructure Details Column -->
                        <div class="col-md-6">
                            <div class="card h-100 border-0 shadow-sm">
                                <div class="card-header bg-light py-3">
                                    <h5 class="card-title mb-0">
                                        <i class="fas fa-info-circle me-2 text-primary"></i>Informations Générales
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="row mb-3">
                                        <div class="col-5 text-muted">Nom:</div>
                                        <div class="col-7 fw-bold" id="detailNom"></div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col-5 text-muted">Type:</div>
                                        <div class="col-7 fw-bold" id="detailType"></div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col-5 text-muted">Localisation:</div>
                                        <div class="col-7 fw-bold" id="detailLocalisation"></div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col-5 text-muted">Capacité:</div>
                                        <div class="col-7 fw-bold" id="detailCapacite"></div>
                                    </div>
                                    <div class="row">
                                        <div class="col-5 text-muted">État:</div>
                                        <div class="col-7">
                                            <span class="badge" id="detailEtat"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- File Upload and Existing Files Column -->
                        <div class="col-md-6">
                            <div class="card h-100 border-0 shadow-sm">
                                <div class="card-header bg-light py-3">
                                    <h5 class="card-title mb-0">
                                        <i class="fas fa-file-upload me-2 text-primary"></i>Documents et Médias
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <!-- File Upload Section -->
                                    <div class="mb-4">
                                        <label for="documentUpload" class="form-label">
                                            <i class="fas fa-cloud-upload-alt me-2 text-primary"></i>Télécharger des documents
                                        </label>
                                        <div class="upload-container">
                                            <input type="file" 
                                                   class="form-control file-input" 
                                                   id="documentUpload" 
                                                   multiple 
                                                   accept=".pdf,.jpg,.jpeg,.png"
                                                   aria-describedby="fileUploadHelp">
                                            <div class="upload-overlay">
                                                <i class="fas fa-cloud-upload-alt"></i>
                                                <p>Glissez et déposez ou cliquez pour télécharger</p>
                                            </div>
                                        </div>
                                        <small id="fileUploadHelp" class="form-text text-muted">
                                            Formats acceptés : PDF, JPG, PNG (max 10 Mo par fichier)
                                        </small>
                                        <div id="uploadedFilesList" class="mt-3 row g-2"></div>
                                    </div>

                                    <!-- Existing Files Section -->
                                    <div class="mt-4">
                                        <div id="existingFilesContainer"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="modal-footer bg-light p-4 border-0">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Fermer
                    </button>
                    <div class="btn-group" role="group">
                        <button type="button" class="btn btn-primary" id="saveInfrastructureDetailsBtn">
                            <i class="fas fa-save me-2"></i>Enregistrer les modifications
                        </button>
                        <button type="button" class="btn btn-outline-primary dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false">
                            <span class="visually-hidden">Actions supplémentaires</span>
                        </button>
                        <ul class="dropdown-menu">
                            <li>
                                <a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#stepConnectionConfigModal">
                                    <i class="fas fa-link me-2"></i>Se connecter à la STEP
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- STEP Connection Configuration Modal -->
    <div class="modal fade" id="stepConnectionConfigModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content shadow-lg">
                <div class="modal-header bg-gradient-primary text-white p-4 border-0">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-water fa-2x me-3 text-white-50"></i>
                        <div>
                            <h3 class="modal-title mb-1">Configuration de Connexion STEP</h3>
                            <small class="text-white-75">Paramètres de connexion selon les standards Veolia OTV</small>
                        </div>
                    </div>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                
                <div class="modal-body p-4">
                    <div class="row g-4">
                        <!-- Network Configuration Column -->
                        <div class="col-md-6">
                            <div class="card h-100 border-0 shadow-sm">
                                <div class="card-header bg-light py-3">
                                    <h5 class="card-title mb-0">
                                        <i class="fas fa-network-wired me-2 text-primary"></i>Configuration Réseau
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <label for="stepIpAddress" class="form-label">Adresse IP de la STEP</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fas fa-server"></i></span>
                                            <input type="text" class="form-control" id="stepIpAddress" placeholder="192.168.1.100" pattern="^(\d{1,3}\.){3}\d{1,3}$" required>
                                        </div>
                                        <small class="form-text text-muted">Adresse IP unique de l'infrastructure STEP</small>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="stepPort" class="form-label">Port de Communication</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fas fa-plug"></i></span>
                                            <input type="number" class="form-control" id="stepPort" placeholder="502" min="1" max="65535" required>
                                        </div>
                                        <small class="form-text text-muted">Port standard Modbus TCP/IP</small>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="stepProtocol" class="form-label">Protocole de Communication</label>
                                        <select class="form-select" id="stepProtocol" required>
                                            <option value="">Sélectionner un protocole</option>
                                            <option value="modbus_tcp">Modbus TCP/IP</option>
                                            <option value="bacnet_ip">BACnet/IP</option>
                                            <option value="profinet">Profinet</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Veolia OTV Configuration Column -->
                        <div class="col-md-6">
                            <div class="card h-100 border-0 shadow-sm">
                                <div class="card-header bg-light py-3">
                                    <h5 class="card-title mb-0">
                                        <i class="fas fa-cogs me-2 text-primary"></i>Paramètres Veolia OTV
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <label for="stepIdentifier" class="form-label">Identifiant Unique Veolia</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fas fa-fingerprint"></i></span>
                                            <input type="text" class="form-control" id="stepIdentifier" placeholder="STEP-OTV-2024-001" required>
                                        </div>
                                        <small class="form-text text-muted">Code d'identification unique Veolia OTV</small>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="stepTreatmentCapacity" class="form-label">Capacité de Traitement</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" id="stepTreatmentCapacity" placeholder="50000" required>
                                            <span class="input-group-text">m³/jour</span>
                                        </div>
                                        <small class="form-text text-muted">Capacité journalière de traitement des eaux</small>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="stepComplianceLevel" class="form-label">Niveau de Conformité</label>
                                        <select class="form-select" id="stepComplianceLevel" required>
                                            <option value="">Sélectionner un niveau</option>
                                            <option value="niveau_1">Niveau 1 - Conformité Basique</option>
                                            <option value="niveau_2">Niveau 2 - Conformité Avancée</option>
                                            <option value="niveau_3">Niveau 3 - Conformité Optimale</option>
                                        </select>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="stepEnvironmentalCertification" class="form-label">Certification Environnementale</label>
                                        <select class="form-select" id="stepEnvironmentalCertification" required>
                                            <option value="">Sélectionner une certification</option>
                                            <option value="iso_14001">ISO 14001</option>
                                            <option value="iso_45001">ISO 45001</option>
                                            <option value="iso_50001">ISO 50001</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Additional Configuration Section -->
                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="card border-0 shadow-sm">
                                <div class="card-header bg-light py-3">
                                    <h5 class="card-title mb-0">
                                        <i class="fas fa-exchange-alt me-2 text-primary"></i>Paramètres de Connexion Supplémentaires
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-4 mb-3">
                                            <label for="stepUsername" class="form-label">Nom d'Utilisateur</label>
                                            <input type="text" class="form-control" id="stepUsername" placeholder="utilisateur_step">
                                        </div>
                                        <div class="col-md-4 mb-3">
                                            <label for="stepPassword" class="form-label">Mot de Passe</label>
                                            <div class="input-group">
                                                <input type="password" class="form-control" id="stepPassword" placeholder="••••••••">
                                                <button class="btn btn-outline-secondary" type="button" id="toggleStepPassword">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                            </div>
                                        </div>
                                        <div class="col-md-4 mb-3">
                                            <label for="stepConnectionTimeout" class="form-label">Délai de Connexion</label>
                                            <div class="input-group">
                                                <input type="number" class="form-control" id="stepConnectionTimeout" placeholder="30" min="5" max="300">
                                                <span class="input-group-text">secondes</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="modal-footer bg-light p-4 border-0">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Annuler
                    </button>
                    <button type="button" class="btn btn-primary" id="saveStepConnectionConfigBtn">
                        <i class="fas fa-save me-2"></i>Enregistrer la Configuration
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Lightbox Modal for Image Viewer -->
    <div class="modal fade" id="imageLightboxModal" tabindex="-1">
        <div class="modal-dialog modal-fullscreen">
            <div class="modal-content bg-dark bg-opacity-90">
                <div class="modal-header border-0">
                    <h5 class="modal-title text-white" id="lightboxImageTitle"></h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body d-flex justify-content-center align-items-center">
                    <img id="lightboxImage" src="" class="img-fluid" alt="Image">
                </div>
                <div class="modal-footer border-0">
                    <a href="#" id="lightboxDownloadLink" class="btn btn-outline-light" download>
                        <i class="fas fa-download me-2"></i>Télécharger
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Custom CSS for enhanced styling -->
    <style>
        /* Gradient background for header */
        .bg-gradient-primary {
            background: linear-gradient(to right, #4e73df 0%, #224abe 100%) !important;
        }

        /* Status badge styling */
        #detailEtat.badge {
            font-size: 0.9em;
            padding: 0.35em 0.65em;
            text-transform: capitalize;
            color: black !important;
        }

        #detailEtat.badge-success {
            background-color: rgba(40, 167, 69, 0.2);
            border: 1px solid rgba(40, 167, 69, 0.3);
        }

        #detailEtat.badge-warning {
            background-color: rgba(255, 193, 7, 0.2);
            border: 1px solid rgba(255, 193, 7, 0.3);
        }

        #detailEtat.badge-danger {
            background-color: rgba(220, 53, 69, 0.2);
            border: 1px solid rgba(220, 53, 69, 0.3);
        }

        /* Existing files container */
        #existingFilesContainer .card {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        #existingFilesContainer .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 0.5rem 1rem rgba(0,0,0,0.15);
        }

        /* Improved text-muted color for better readability */
        .modal-body .text-muted {
            color: rgba(108, 117, 125, 0.7) !important;
        }

        /* Ensure consistent font weight for labels */
        .modal-body .text-muted {
            font-weight: 500;
        }

        /* Upload Container Styles */
        .upload-container {
            position: relative;
            border: 2px dashed #4e73df;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            transition: background-color 0.3s ease;
        }

        .upload-container:hover {
            background-color: rgba(78, 115, 223, 0.1);
        }

        .upload-container .file-input {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
            z-index: 10;
        }

        .upload-overlay {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #4e73df;
        }

        .upload-overlay i {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        /* Image Grid Styles */
        .image-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            padding: 10px;
            background-color: #f8f9fc;
            border-radius: 10px;
        }

        .image-grid .file-card {
            position: relative;
            border-radius: 10px;
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }

        .image-grid .file-card:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .image-grid .file-card .file-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to bottom, transparent, rgba(0,0,0,0.7));
            color: white;
            padding: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .image-grid .file-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .no-files-placeholder {
            grid-column: 1 / -1;
            text-align: center;
            color: #6c757d;
            padding: 30px;
        }

        /* Lightbox Modal Styles */
        #imageLightboxModal .modal-body {
            max-height: 90vh;
        }

        #lightboxImage {
            max-height: 90vh;
            max-width: 100%;
            object-fit: contain;
        }

        /* iPhone-like Gallery Grid Styles */
        .iphone-gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            padding: 10px;
        }

        .gallery-item {
            position: relative;
            border-radius: 10px;
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }

        .gallery-item:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .gallery-item-content {
            position: relative;
            padding-bottom: 100%;
        }

        .gallery-item-content img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .gallery-item-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, transparent, rgba(0,0,0,0.7));
            color: white;
            padding: 10px;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
        }

        .gallery-item-details {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .gallery-item-name {
            font-size: 0.9em;
        }

        .gallery-item-actions {
            display: flex;
            justify-content: flex-end;
        }

        .gallery-item-actions button, .gallery-item-actions a {
            margin-left: 10px;
        }

        .pdf-item {
            background-color: #f8f9fc;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .pdf-icon {
            font-size: 3rem;
            color: #6c757d;
        }

        /* Enhanced File Tabs Styling */
        .file-tabs-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 10px 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .file-tabs {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .file-tabs .btn {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 6px 12px;
            border-radius: 20px;
            transition: all 0.3s ease;
        }

        .file-tabs .btn i {
            margin-right: 6px;
        }

        .file-tabs .btn.active {
            background-color: #007bff;
            color: white;
            box-shadow: 0 2px 5px rgba(0,123,255,0.3);
        }

        .file-tabs .btn:not(.active) {
            background-color: transparent;
            color: #6c757d;
            border-color: #e9ecef;
        }

        .file-tabs .btn:hover:not(.active) {
            background-color: #e9ecef;
            color: #495057;
        }

        .file-tabs-info {
            display: flex;
            align-items: center;
            font-size: 0.875rem;
            color: #6c757d;
        }

        .file-tabs-info i {
            margin-right: 6px;
            color: #007bff;
        }

        @media (max-width: 576px) {
            .file-tabs-container {
                flex-direction: column;
                align-items: stretch;
            }

            .file-tabs {
                margin-bottom: 10px;
                flex-direction: column;
                align-items: stretch;
            }

            .file-tabs .btn {
                margin-bottom: 8px;
                width: 100%;
            }

            .file-tabs-info {
                text-align: center;
            }
        }
    </style>

    <script src="{{ url_for('static', filename='js/infrastructures.js') }}"></script>
</div>
{% endblock %}

{% block page_scripts %}
{% endblock %}
