{% extends "base.html" %}

{% block title %}Bilans Mensuels{% endblock %}

{% block extra_css %}
<style>
    .editor-container {
        max-width: 1200px;
        margin: 20px auto;
        padding: 20px;
        background-color: #f9f9f9;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    #editor-actions {
        margin-bottom: 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="editor-container">
        <div id="editor-actions">
            <h2>Bilans Mensuels - Éditeur de Document</h2>
            <div>
                <button id="save-document" class="btn btn-primary">
                    <i class="fas fa-save"></i> Enregistrer
                </button>
                <button id="export-pdf" class="btn btn-secondary">
                    <i class="fas fa-file-pdf"></i> Exporter PDF
                </button>
            </div>
        </div>
        <textarea id="document-editor"></textarea>
    </div>
</div>
{% endblock %}

{% block page_scripts %}
<script src="https://cdn.tiny.cloud/1/no-api-key/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        tinymce.init({
            selector: '#document-editor',
            height: 600,
            plugins: 'advlist autolink lists link image charmap preview',
            toolbar: 'undo redo | styles | bold italic underline | alignleft aligncenter alignright alignjustify | ' +
                     'bullist numlist outdent indent | link image',
            menubar: 'file edit view insert format tools',
            language: 'fr_FR',
            content_style: 'body { font-family:Arial,sans-serif; font-size:14px }',
            
            setup: function(editor) {
                // Save document functionality
                document.getElementById('save-document').addEventListener('click', function() {
                    const content = editor.getContent();
                    // TODO: Implement actual save mechanism (AJAX/fetch)
                    console.log('Document content:', content);
                    alert('Document sauvegardé localement');
                });

                // Export to PDF functionality (client-side)
                document.getElementById('export-pdf').addEventListener('click', function() {
                    const content = editor.getContent();
                    // You might want to use a library like html2pdf.js for this
                    alert('Exportation PDF à implémenter côté serveur');
                });
            }
        });
    });
</script>
{% endblock %}